# 📋 执行命令清单

## ✅ 配置已完成

所有代码修改已完成，现在需要执行以下命令来部署：

## 🚀 步骤 1: 提交代码到 Git

```bash
# 切换到前端目录
cd frontend

# 查看修改的文件
git status

# 添加所有修改
git add .

# 提交更改
git commit -m "配置 Vercel 代理解决混合内容问题"

# 推送到 GitHub
git push origin main
```

## 🔍 步骤 2: 验证配置

### 检查 vercel.json 配置

确认 `frontend/vercel.json` 内容为：

```json
{
  "rewrites": [
    {
      "source": "/api/backend/:path*",
      "destination": "http://8.148.177.179:5000/api/:path*"
    }
  ]
}
```

### 检查前端代码

确认 `frontend/src/services/api.js` 中：

```javascript
const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 
  (import.meta.env.PROD ? '/api/backend' : 'http://localhost:5000/api');
```

## ⏳ 步骤 3: 等待 Vercel 自动部署

1. 推送代码后，Vercel 会自动检测
2. 进入 Vercel 控制台查看部署状态
3. 等待部署完成（通常 1-3 分钟）

## ✅ 步骤 4: 验证连接

部署完成后：

1. 打开 https://ship-steel.vercel.app/
2. 按 **F12** 打开开发者工具
3. 查看 **Console** 标签，应该看到：
   ```
   🔧 API 配置信息:
     - API_BASE_URL: /api/backend
     - 当前环境: production
   ```
4. 查看 **Network** 标签
5. 查找对 `/api/backend/health` 的请求
6. 应该看到请求成功（状态码 200）

## 🔧 本地测试（可选）

如果你想在本地测试代理配置：

```bash
cd frontend

# 安装依赖（如果还没安装）
npm install

# 构建生产版本
npm run build

# 预览构建结果
npm run preview
```

## 📝 快速命令（一键执行）

如果你想一次性执行所有 Git 命令：

```bash
cd frontend && \
git add . && \
git commit -m "配置 Vercel 代理解决混合内容问题" && \
git push origin main
```

## 🎯 预期结果

配置成功后：

- ✅ 前端使用 HTTPS (https://ship-steel.vercel.app/)
- ✅ API 请求使用相对路径 (/api/backend/...)
- ✅ Vercel 自动代理到后端 (http://8.148.177.179:5000/api/...)
- ✅ 不再有混合内容错误
- ✅ 后端服务连接成功

## ⚠️ 如果遇到问题

### 问题 1: Git 推送失败

```bash
# 检查 Git 状态
git status

# 检查远程仓库
git remote -v

# 如果需要，添加远程仓库
git remote add origin https://github.com/你的用户名/仓库名.git
```

### 问题 2: Vercel 部署失败

1. 检查 Vercel 控制台的部署日志
2. 确认 `vercel.json` 格式正确（JSON 格式）
3. 确认所有文件都已提交到 Git

### 问题 3: 部署后仍然无法连接

1. 清除浏览器缓存 (Ctrl+Shift+Delete)
2. 强制刷新页面 (Ctrl+F5)
3. 检查浏览器控制台的错误信息
4. 确认后端服务正常运行: `http://8.148.177.179:5000/api/health`

---

**准备好后，执行上面的 Git 命令即可！** 🚀

